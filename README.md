# django_concurrent_edit

Testing several solutions of blocking concurrent editing models in admin panel.

# Тестирование

[Ссылка на Issue #11](https://github.com/devmanorg/dvmn.org/issues/10)

[Демо, которое можно тестировать](http://46.101.245.26:8002/admin/)

Есть два пользователя `admin` и `user`. Пароль у обоих - `1`.

Если один открывает пост для редактирования, то при открытии у второго срабатывает предупреждение, что пост открыт
другим пользователем и указано последнее время редактирования (пока в UTC).

Если второй пользователь начинает редактировать пост, несмотря на предупреждение, то у первого (в течении 30 сек.)
срабатывает alert, что этот пост начал редактировать другой пользователь.

Если у одного пользователя открыто больше одной вкладки, то на второй срабатывает alert, что вкладок больше одной.

# Техническая реализация

В admin.py редактируемой модели изменены методы `change_view` и
`save_model`.

Также мы расширяем template админки `change_form_template`, добавляя код JS.

Отслеживание изменений происходит через созданную модель `editing_now.models.EditingNow`. Запросы в базу отправляются
только при активности пользователя на странице раз в 30 секунд. Если пользователь на вкладе не активен более 2 минут,
запросы прекращаются. 

